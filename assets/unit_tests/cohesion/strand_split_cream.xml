<scene>
  <description text="Two strands initially hang vertically with a distance of 0.01cm between their centerlines. We then gradually separate them. Cream is used for surface flow."/>

  <duration time="4.0"/>
  <integrator type="linearized-implicit-euler" dt="0.001" criterion="1e-9" maxiters="1000"/>
  <collision type="continuous-time"/>

  <simplegravity fx="0.0" fy="-981.0"/>

  <bucketinfo size="4.0" numcells="4"/>

  <liquidinfo>
    <surfTensionCoeff value="44.8"/>
    <affineStretchDamping value="0.1"/>
    <affineRotateDamping value="0.1"/>
    <velocityDamping value="0.004"/>
    <liquidBulkModulus value="1.09e6"/>
    <liquidDensity value="0.2"/>
    <implicitElasticity value="1"/>
    <liquidBoundaryFriction value="0.99"/>
    <shearPcgCriterion value="1e-6"/>
    <particleCellMultiplier value="0.25"/>
  </liquidinfo>

  <StrandParameters>
    <radius value="0.005"/>
    <youngsModulus value="1.047e10"/>
    <poissonRatio value="0.37" />
    <collisionMultiplier value="1.0"/>
    <attachMultiplier value="1.0" />
    <density value="1.32" /> 
    <viscosity value="0.0" />
    <baseRotation value="0.0"/>
    <accumulateWithViscous value="1"/>
    <accumulateViscousOnlyForBendingModes value="0"/>
    <frictionAngle value="40.0"/>
    <stretchMultiplier value="1.0"/>
  </StrandParameters>

  <CollisionParameters>
    <constantCollisionRadius value="1"/>
    <externalCollisionsRadius value="0.0055"/>
    <selfCollisionsRadius value="0.0055"/>
    <impulseMaxNorm value="0"/>
    <maxNumCollisionsPerEdge value="6"/>
  </CollisionParameters>

  <SimulationParameters>
    <airDrag value="0.0005"/> 
    <gaussSeidelIterations value="75"/>
    <gaussSeidelTolerance value="1e-04"/> 
    <maxNewtonIterations value="40"/>
    <hairMeshFrictionCoefficient value="0.0"/>
    <numberOfThreads value="24"/>
    <percentCTRodRodCollisionsAccept value="100"/>
    <pruneExternalCollisions value="1"/>
    <pruneSelfCollisions value="1"/>
    <rodSubSteps value="1"/>
    <simulationManagerLimitedMemory value="0"/>
    <skipFlowFrictions value="1"/>
    <skipRodMeshCollisions value="0"/>
    <skipRodRodCollisions value="0"/>
    <statGathering value="0"/>
    <stochasticPruningFraction value="0.8"/>
    <hairHairFrictionCoefficient value="0.16"/>
    <substeps value="1"/>
    <useApproxRodElasticFriction value="1"/>
    <useCTRodRodCollisions value="0"/>
    <useImpulseMethod value="0"/>
    <useLengthProjection value="0"/>
    <useNonlinearContacts value="0"/>
    <useSoftAttachConstraints value="0"/>
    <usePreFilterGeometry value="0"/>
    <solveLiquids value="0"/>
  </SimulationParameters>


  <particle h="0.005" x="0.005 9.75 0.0" v="0.0 0.0 0.0" fixed="3" group="0"/>
  <particle h="0.005" x="0.005 9.25 0.0" v="0.0 0.0 0.0" fixed="1" group="0"/>
  <particle h="0.005" x="0.005 8.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 8.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 7.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 7.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 6.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 6.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 5.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 5.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 4.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 4.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 3.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 3.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 2.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 2.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 1.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 1.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 0.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 0.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -0.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -0.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -1.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -1.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -2.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -2.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -3.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -3.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -4.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -4.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -5.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -5.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -6.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -6.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -7.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -7.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -8.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -8.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -9.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="0.005 -9.75 0.0" v="0.0 0.0 0.0" fixed="0"/>

  <particle h="0.005" x="-0.005 9.75 0.0" v="0.0 0.0 0.0" fixed="3" group="1"/>
  <particle h="0.005" x="-0.005 9.25 0.0" v="0.0 0.0 0.0" fixed="1" group="1"/>
  <particle h="0.005" x="-0.005 8.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 8.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 7.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 7.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 6.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 6.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 5.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 5.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 4.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 4.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 3.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 3.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 2.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 2.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 1.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 1.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 0.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 0.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -0.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -0.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -1.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -1.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -2.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -2.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -3.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -3.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -4.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -4.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -5.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -5.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -6.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -6.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -7.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -7.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -8.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -8.75 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -9.25 0.0" v="0.0 0.0 0.0" fixed="0"/>
  <particle h="0.005" x="-0.005 -9.75 0.0" v="0.0 0.0 0.0" fixed="0"/>

  <hair params="0" start="0" count="40"/>
  <hair params="0" start="40" count="40"/>

  <script type="translate" x="2.0" y="0.0" z="0.0" w="0.0" start="0.0" end="1.0" group="0"/>  
  <script type="translate" x="-2.0" y="0.0" z="0.0" w="0.0" start="0.0" end="1.0" group="1"/>  
</scene>
